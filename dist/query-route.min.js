(e=>{const t="pageshow",a="hash",o="browser",r="back",s="/",l="",i={},n=(t,a=!0)=>{t===r?null!=e.history.state&&e.history.back():e.history.pushState?b({title:t,url:h(t)},a):e.location.assign(i.url)},c=(e,t)=>{if(t[0]===l&&t.length>0&&t.shift(),e[0]!=t[0])return!1;let a={};for(let o in e)if(e[o]!=t[o])if(":"==t[o].slice(0,1))a[t[o].slice(1)]=e[o];else if(e[o]!=t[o])return!1;return a},h=t=>{if(v.style===a)return e.location.origin+e.location.pathname+(g(t)?l:"#"+t);if(v.style===o){const a=d(t)?v.root+f(t):e.location.pathname+s+t;return e.location.origin+a}return l},u=()=>[v.root,s],p=()=>new RegExp(`^(${u().join("|")})`),f=e=>e.replace(p(),l),g=e=>u().includes(e),d=e=>e.match(p()),m=t=>t??v.style===o?e.location.pathname.slice(v.root.length):v.style===a?e.location.hash.slice(1):l,y=(e={},t=(()=>{}),a)=>{let o=m(a),r=o.split(s),i={};if(o!==l)for(let[a,l]of Object.entries(e)){if(i={},a===o){t=l;break}let e=a.split(s);if(e[0]===r[0]&&e.length===r.length&&(i=c(r,e),!1!==i)){t=l;break}}return e=>t(i,e)},v={state:i,root:s,style:a,navigate:n,matches:c,makenext:h,roots:u,rootregexp:p,rootremove:f,isroot:g,hasroot:d,getroot:m,make:y},k=a=>e.document.dispatchEvent(new CustomEvent(t,{detail:{nextPage:{...a},prevPage:{...i}}})),b=(t,a)=>{null===t&&(t={title:m(),url:e.location.href}),e.history[a?"pushState":"replaceState"](t,t.title,t.url),k(t),Object.assign(i,t)};if(e.q&&e.document){const s=async({page:e,data:t,selector:a=""})=>{try{let o=await e(t);q(a).html(o)}catch(e){throw e}},i=({routes:a={},defaultPage:o=(()=>l),errorPage:r=(e=>`Error: ${e}`),selector:s=".app"})=>{q(e.document).on(t,(async()=>{try{const e=y(a,o);await v.makepage({page:e,selector:s})}catch(e){throw v.makepage({page:r,selector:s,data:e}),"Page failed: "+e}}))};q((()=>{q(e.document).delegate("click","a",(function(e){if(v.style===a&&"#"===this.href[0]){e.preventDefault();const t=this.attributes.href.value.slice(1);t!==l&&n(t)}else if(v.style===o&&"link"===this.dataset.role){e.preventDefault();const t=this.attributes.href;t!==l&&n(t.value)}else v.style===o&&this.dataset.rel===r&&(e.preventDefault(),n(r))}))})),Object.assign(v,{makepage:s,init:i}),q.route=v}else e.route=v;e.addEventListener("load",(()=>{setTimeout((()=>e.addEventListener("popstate",(e=>b(e.state)))),0)})),e.addEventListener("DOMContentLoaded",(e=>{b(null)}))})(window);