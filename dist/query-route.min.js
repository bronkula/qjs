(e=>{const t={},a={root:"/",style:"hash",navigate:(s,o=!0)=>{"back"==s?null!=e.history.state&&e.history.back():e.history.pushState?l({title:s,url:"hash"===a.style?e.location.origin+e.location.pathname+"#"+s:"browser"===a.style?e.location.origin+a.root+(s!==a.root?s:""):""},o):e.location.assign(t.url)},matches:(e,t)=>{if(e[0]!=t[0])return!1;let a={};for(let l in e)if(e[l]!=t[l])if(":"==t[l].slice(0,1))a[t[l].slice(1)]=e[l];else if(e[l]!=t[l])return!1;return a},getroot:t=>t??"browser"===a.style?e.location.pathname.slice(a.root.length):"hash"===a.style?e.location.hash.slice(1):"",make:(e,t=(()=>{}),l)=>{let s=a.getroot(l),o=s.split("/"),r={};if(""!=s)for(let[l,i]of Object.entries(e)){if(r={},l==s){t=i;break}let e=l.split("/");if(e[0]==o[0]&&e.length==o.length&&(r=a.matches(o,e),!1!==r)){t=i;break}}return e=>t(r,e)}},l=(l,s)=>{null==l&&(l={title:"hash"===a.style?e.location.hash.slice(1):"browser"===a.style?e.location.pathname.slice(a.root.length):"",url:e.location.href}),t.state={...l},e.history[s?"pushState":"replaceState"](l,l.title,l.url),e.document.dispatchEvent(new CustomEvent("pageshow",{detail:{nextPage:{...l},prevPage:{...t.state}}}))};e.q&&e.document?(a.makepage=async({page:e,data:t,selector:a=""})=>{try{let l=await e(t);q(a).html(l)}catch(e){throw e}},a.init=({routes:t={},defaultPage:l=(()=>""),errorPage:s=(e=>`Error: ${e}`),selector:o=".app"})=>{q(e.document).on("pageshow",(async e=>{try{const e=a.make(t,l);await a.makepage({page:e,selector:o})}catch(e){throw a.makepage({page:s,selector:o,data:e}),"Page failed: "+e}}))},q((()=>{q(e.document).delegate("click","a",(function(e){if("hash"===a.style&&"#"===this.href[0]){e.preventDefault();let t=this.attributes.href.value.slice(1);""!==t&&a.navigate(t)}else if("browser"===a.style&&"link"===this.dataset.role){e.preventDefault();let t=this.attributes.href;""!==t&&a.navigate(t.value)}else"browser"===a.style&&"back"===this.dataset.rel&&(e.preventDefault(),a.navigate("back"));e.preventDefault()}))})),q.route=a):e.route=a,e.addEventListener("load",(()=>{setTimeout((()=>e.addEventListener("popstate",(e=>l(e.state)))),0)})),e.addEventListener("DOMContentLoaded",(e=>{l(null)}))})(window);