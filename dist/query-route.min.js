(t=>{const e={},a={root:"/",style:"hash",navigate:(s,o=!0)=>{"back"==s?null!=t.history.state&&t.history.back():t.history.pushState?l({title:s,url:"hash"===a.style?t.location.origin+t.location.pathname+"#"+s:t.location.origin+(s!==a.root?a.root:"")+s},o):t.location.assign(e.url)},matches:(t,e)=>{if(t[0]!=e[0])return!1;let a={};for(let l in t)if(t[l]!=e[l])if(":"==e[l].slice(0,1))a[e[l].slice(1)]=t[l];else if(t[l]!=e[l])return!1;return a},make:(e,l=(()=>{}),s)=>{let o="browser"===a.style?t.location.pathname.slice(a.root.length):"hash"===a.style?s||t.location.hash.slice(1):"",r=o.split("/"),i={};if(""!=o)for(let[t,s]of Object.entries(e)){if(i={},t==o){l=s;break}let e=t.split("/");if(e[0]==r[0]&&e.length==r.length&&(i=a.matches(r,e),!1!==i)){l=s;break}}return t=>l(i,t)}},l=(l,s)=>{null==l&&(l={title:"hash"===a.style?t.location.hash.slice(1):"browser"===a.style?t.location.pathname.slice(a.root.length):"",url:t.location.href}),e.state={...l},t.history[s?"pushState":"replaceState"](l,l.title,l.url),t.document.dispatchEvent(new CustomEvent("pageshow",{detail:{nextPage:{...l},prevPage:{...e.state}}}))};t.q&&t.document?(a.init=({routes:e={},defaultPage:a=(()=>""),errorPage:l=(t=>`Error: ${t}`),selector:s=".app"})=>{q(t.document).on("pageshow",(async t=>{const o=async(t,e)=>{try{let a=await t(e);q(s).html(a)}catch(t){throw t}};try{const t=q.route.make(e,a);await o(t)}catch(t){throw o(l,t),"Page failed: "+t}}))},q((()=>{q(t.document).delegate("click","a",(function(t){if(console.log({route:a,data:this.dataset.role}),"hash"===a.style&&"#"===this.href[0]){t.preventDefault();let e=this.attributes.href.value.slice(1);""!==e&&a.navigate(e)}else if("browser"===a.style&&"link"===this.dataset.role){t.preventDefault();let e=this.attributes.href;""!==e&&a.navigate(e.value)}else"browser"===a.style&&"back"===this.dataset.rel&&(t.preventDefault(),a.navigate("back"));t.preventDefault()}))})),q.route=a):t.route=a,t.addEventListener("load",(()=>{setTimeout((()=>t.addEventListener("popstate",(t=>l(t.state)))),0)})),t.addEventListener("DOMContentLoaded",(t=>{l(null)}))})(window);